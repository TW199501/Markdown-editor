# TODO 2025-11-22 01

## 主題：初始理解 @gravity-ui/markdown-editor 專案（架構與開發流程）

本檔用來記錄第一次進入 @gravity-ui/markdown-editor 開源專案時的「初始理解」與後續掃描／文件產出計畫，暫不修改任何程式碼。

### [問題標題]

- 為後續整合與客製化建立專案總覽與前端架構說明：
  - 快速掌握專案目標、技術棧、目錄結構與啟動／建置方式。
  - 為後續的 bugfix 或功能調整打好基礎。

### [背景與重現步驟]

- 專案來源：開源套件 `@gravity-ui/markdown-editor`（MIT License）。
- 目前狀態：
  - 尚未在本機執行任何指令，只進行文件與設定檔閱讀。
  - 主要參考：
    - `README.md`
    - `package.json`
    - `tsconfig.json`
    - `docs/rule/*.md`（ELF 團隊協作與 AI 上手規則）
- 相關開發指令（尚未執行，僅從文件整理）：

```bash
# 啟動 Storybook 開發環境
npm start

# 建置套件
npm run build

# 執行測試
npm test
```

### [相關檔案路徑與定位]

- 專案根目錄：
  - `README.md`：套件說明、主要功能、開發指令。
  - `README-ru.md`：俄文版說明。
  - `package.json`：
    - npm 套件名稱：`@gravity-ui/markdown-editor`。
    - 建置腳本（`npm run build` -> `gulp`）。
    - Storybook 開發（`npm start` -> `storybook dev`）。
    - 測試與 Playwright、lint 相關指令。
    - 依賴與 peerDependencies（React、@gravity-ui/uikit、@diplodoc/*、Codemirror、ProseMirror 等）。
  - `tsconfig.json`：
    - `extends`: `@gravity-ui/tsconfig/tsconfig`。
    - `compilerOptions`: `target: ES2022`、`module: esnext`、`jsx: react-jsx`、`moduleResolution: bundler` 等。
    - `paths`: `#core`、`#cm/*`、`#pm/*`、`src/*` 等別名。
  - `gulpfile.js`：建置流程（尚未展開閱讀）。
  - `jest.config.js`：測試設定（尚未展開閱讀）。
  - `src/`：主要程式碼（React + ProseMirror + CodeMirror，尚待細讀）。
  - `demo/`：示例與 Storybook 相關內容。
  - `tests/`：Jest、Playwright 等測試程式。
- 文件相關：
  - `docs/`：
    - 多份 how-to 類文件（整合 CRA、Next.js、preview、extensions 等）。
    - `docs/rule/1-1ELF_EXPRESS_RULES.md`：ELF 團隊通用協作規則。
    - `docs/rule/1-2ELF_AI_ONBOARDING.md`：AI 上手與文件結構約定。
    - `docs/rule/1-3ELF_API_OVERVIEW.md`：API 文件與模組對照的原則。
    - `docs/rule/1-4todoYYYY-MM-DD-XX.md`：每日 todo 模板與協作流程圖。
    - `docs/todo/`：目前空資料夾，本檔為第一個 todo。

### [分析與方案]

1. 專案初步理解（來自 README / package.json / tsconfig）：
   - 這是一個 **React 生態下的 Markdown 編輯器套件**，同時支援 WYSIWYG 與原始標記（markup）模式。
   - 功能重點：
     - 支援基本 Markdown 與 YFM 語法。
     - 以 ProseMirror（WYSIWYG）與 CodeMirror（markup）作為核心編輯引擎。
     - 透過 extensions 機制擴充（HTML、LaTeX、Mermaid、GPT 等）。
   - 開發工作流：
     - 本地開發主要透過 Storybook（`npm start`）。
     - 建置透過 Gulp（`npm run build` -> `gulp`），輸出 ESM/CJS 與型別定義，在 `build/` 目錄下。
     - 測試透過 Jest 與 Playwright（含 visual / e2e 測試）。
   - TypeScript 與模組設定：
     - TS target ES2022，使用 `react-jsx`，`moduleResolution: bundler`，符合理想的現代前端設定。
     - 使用 path alias（`#core`、`#cm/*`、`#pm/*`、`src/*`）來管理核心模組與編輯引擎層。

2. 後續閱讀與掃描計畫：
   - **目錄層級掃描**（不立即深入所有檔案）：
     - `src/`：了解核心模組分層（例如 `core/`、`view/`、`extensions/` 等實際存在的子資料夾）。
     - `demo/`：看看如何在示例中組裝 editor（有助於 FRONTEND_ARCH）。
     - `tests/`：了解主要測試覆蓋範圍與關鍵行為假設。
   - **建置與開發管線**：
     - 閱讀 `gulpfile.js`，了解 build 的輸出結構與步驟。
     - 閱讀 `jest.config.js`，了解測試環境與 moduleNameMapper 等設定。
   - **說明文件**：
     - 瀏覽 `docs/how-to-*.md` 系列，整理：
       - 如何在 CRA / Next.js 中整合此 editor。
       - 常見 extension 的接入方式。
       - 工具列、預覽與自訂樣式的擴充點。

3. 預計產出文件（依 ELF 規則）：
   - `docs/PROJECT_OVERVIEW.md`（目前尚不存在）：
     - 內容預期包含：
       - 專案目標與定位（React Markdown 編輯器套件）。
       - 技術棧（React、TS、ProseMirror、CodeMirror、Storybook、Gulp、Jest、Playwright 等）。
       - 目錄結構簡介（`src/`、`demo/`、`tests/`、`docs/` 等）。
       - 主要指令（開發、建置、測試）。
   - `docs/FRONTEND_ARCH.md`（目前尚不存在）：
     - 內容預期包含：
       - 套件本身的啟動流程／組裝方式（從 `useMarkdownEditor` 到 `MarkdownEditorView`）。
       - 與 Storybook／demo 的關係（開發時如何掛載 editor）。
       - 模組分層：core / view / extensions / integration 等（以實際 `src/` 結構為準）。
   - 其他文件：
     - 依 ELF 規則，不新增額外頂層 docs 檔案，細節與實驗一律寫在 `docs/todo/*.md`。

4. 後續步驟（本 todo 之後的工作）
   - 依上述掃描計畫，逐步閱讀：
     - `src/` 目錄結構與關鍵模組。
     - `demo/` 中 editor 的實際使用方式。
     - `gulpfile.js` 與 `jest.config.js`。
   - 在完成初步掃描後：
     - 起草 `docs/FRONTEND_ARCH.md`。
   - 所有具體實作或 build / test 嘗試，將在後續 todo 或本檔的「實作重點摘要」與「驗證與結果」中補充。

### [實作重點摘要]

- 本次完成：
  - 新增 `docs/todo/todo2025-11-22-01.md` 檔案。
  - 紀錄專案初始理解與後續掃描／文件產出計畫。
  - 掃描 `demo/` 結構。
  - 創建 `docs/PROJECT_OVERVIEW.md`。
- 尚未修改任何程式碼、設定檔或 build / test 腳本。

### [驗證與結果]

- 目前僅為分析與計畫階段：
  - **尚未執行** `npm start`、`npm run build`、`npm test` 或其他指令。
  - 等開始進行實際改動或建置／測試時，會在本節補充實際執行的指令與結果（成功／失敗與錯誤摘要）。
- 下一步 TODO：
  - 依「分析與方案」中的掃描計畫，進一步閱讀 `src/`、`gulpfile.js`、`jest.config.js` 等，為撰寫 `FRONTEND_ARCH.md` 做準備。
