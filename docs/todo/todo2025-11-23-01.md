# TODO 2025-11-23 01

## 主題：在自己的應用中整合 @gravity-ui/markdown-editor（含 zh-TW）

本檔作為 2025-11-23 的工作計畫，目標是把目前在本 repo 內完成的 zh-TW i18n 能力，整理成一套「在外部 React/Next/Tauri 專案中實際整合編輯器 UI」的最小指引與程式碼範例，讓未來不會只有在 Storybook 裡玩，而是真正能在自家應用中落地。

### [問題標題]

- 如何在**自己的專案**（非本 repo）中，正確整合 `@gravity-ui/markdown-editor`：
  - 讓編輯器 UI 能正常顯示（含 UIKit 樣式與主題）。
  - 可以選擇語言（包含之後的 `zh-TW`）。
  - 保持與官方文件一致、不要走偏門實作。

### [背景與重現步驟]

- 目前狀態：
  - 已在本 repo 內完成：
    - `Lang.ZhTw = 'zh-TW'`。
    - `registerKeyset` 支援可選 `zh-TW` 字典。
    - 多個 keyset 已新增 `zh-TW.json` 並掛入。
  - Storybook 8.4.1 可以在本機啟動，demo UI 可用。
  - `README_ZH.md` 已有「快速開始」範例與 i18n 說明，並補充 `lang: 'zh-TW'` 示例。
- 但目前這些成果主要都停留在「本 repo / Storybook demo」層級：
  - 還沒有一份清楚的說明：「如果我要在自己的 React/Next/Tauri 專案裡用這個 editor，要一步步做什麼？」
  - zh-TW 目前只在本地 fork 裡存在，尚未 upstream / 發版。

### [相關檔案路徑與定位]

- 本 repo 內：
  - `src/configure.ts`：定義 `Lang` enum 與 `configure({lang})`。
  - `src/i18n/i18n.ts`：`registerKeyset` 包裝與 zh-TW 註冊邏輯。
  - `src/i18n/**/zh-TW.json`：各 keyset 的繁體字典。
  - `demo/components/Playground.tsx`：Storybook demo 中的 editor shell 用法。
  - `.storybook/preview.ts` / `demo/hocs/withLang.tsx`：Storybook 中語系切換機制示例。
  - `README_ZH.md`：中文版 README，含安裝、快速開始、i18n 說明。
- 外部參考：
  - Gravity UI 官方頁面：<https://gravity-ui.com/zh/libraries/markdown-editor>
  - 線上 Playground / Docs：<https://preview.gravity-ui.com/md-editor/>

### [分析與方案]

1. 明確整合目標
   - 不在本 repo 直接建新 app，而是：
     - 整理一份**最小整合步驟**（安裝哪些套件、需要哪些設定）。
     - 提供一個可以直接貼到外部專案中的 `App.tsx` / `main.tsx` 風格範例。
   - 先以單純 React（CRA/Vite 類型）為例，之後再視需要延伸 Next/Tauri。

2. 依官方文件整理「最小步驟清單」
   - 從官方 zh 頁面與 README_ZH 提煉出：
     - 需要安裝的依賴（`@gravity-ui/markdown-editor`、`@gravity-ui/uikit`、`@gravity-ui/components`、`@diplodoc/transform` 等）。
     - 需要在應用入口匯入 UIKit 樣式、設定 ThemeProvider。
     - 使用 `useMarkdownEditor + MarkdownEditorView` 建立 UI。
     - 使用 `configure({lang})` 進行 i18n 初始化的正確位置與順序。

3. 草擬 React 最小整合程式碼（示意用）
   - 在本檔或 README_ZH 中，加入類似下列程式碼作為「推薦樣板」：

   ```tsx
   // main.tsx（或 index.tsx）
   import React from 'react';
   import ReactDOM from 'react-dom/client';
   import {ThemeProvider} from '@gravity-ui/uikit';
   import '@gravity-ui/uikit/styles/styles.scss';
   import {App} from './App';

   ReactDOM.createRoot(document.getElementById('root') as HTMLElement).render(
     <ThemeProvider theme="light">
       <App />
     </ThemeProvider>,
   );
   ```

   ```tsx
   // App.tsx
   import React from 'react';
   import {
     useMarkdownEditor,
     MarkdownEditorView,
     configure,
   } from '@gravity-ui/markdown-editor';

   // 未來若官方收錄 zh-TW，這裡即可改成 'zh-TW'
   configure({lang: 'en'});

   export function App() {
     const editor = useMarkdownEditor({allowHTML: false});

     return (
       <div style={{maxWidth: 800, margin: '0 auto', padding: 16}}>
         <MarkdownEditorView editor={editor} stickyToolbar autofocus />
       </div>
     );
   }
   ```

   - 後續若以本地 fork 提供 zh-TW，可在說明中補充：
     - 如何在外部專案的 `package.json` 中使用 `"file:../Markdown editor"` 指向本地版本。
     - 然後將 `configure({lang: 'en'})` 改成 `configure({lang: 'zh-TW'})`。

4. 與 zh-TW i18n 的關聯
   - 清楚在文件中註明：
     - 目前 `zh-TW` 是在本地 fork 內實作，**不代表已在官方 npm 版本中提供**。
     - 外部專案若要直接用 `zh-TW`，需：
       - 要嘛吃本地 fork（`file:` 相依）。
       - 要嘛等未來 upstream 接受 PR 並發版。

5. 里程碑與後續
   - 當這份「最小整合樣板」穩定後，可以：
     - 在 README_ZH 或獨立 docs 檔案中正式收錄。
     - 視需要再為 Next.js / Tauri 整合撰寫專門的指引（SSR、動態載入等注意事項）。

### [實作重點摘要]

- 本日計畫目標：
  - 以本檔為起點，整理出一份「在外部 React 專案中整合 editor」的最小步驟與程式碼範例。
  - 不在本 repo 直接建立新應用，而是提供**可複製到外部專案**的樣板。
  - 將 zh-TW i18n 的實作背景與目前限制（只存在於本地 fork）寫清楚，避免之後混淆官方 npm 版本能力。

- 預期實作項目：
  - [ ] 在 README_ZH 或獨立 docs 檔中，新增「外部整合樣板」段落，包含上面的 `main.tsx` / `App.tsx` 範例。
  - [ ] 在本檔的 `[驗證與結果]` 區段補上：已在實際 React 專案（或最小 sandbox）中試跑成功的結果描述。

### [驗證與結果]

- 目前為 2025-11-23 的計畫檔，尚未填入最終驗證結果；
  本區將在實際於外部專案完成整合並驗證後更新，描述：
  - 成功渲染出 editor UI 的環境（React 版本、打包工具等）。
  - `configure({lang})` 實際使用狀況（目前預期為 `en` / `ru`，未來加上 `zh-TW`）。
  - 有無額外需要注意的樣式 / 依賴問題。
